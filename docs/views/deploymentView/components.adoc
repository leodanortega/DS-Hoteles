== Vista de Interfaces (CBSE)
A continuación, se especifican los contratos formales para cada interfaz de los componentes del sistema, definiendo las precondiciones y poscondiciones de sus operaciones clave.

---

.Diagrama de arquitectura de componentes
image::../images/components/ComponentArchitectureDiagram.jpeg[Diagrama de Arquitectura de componentes, width=600, align=center]

---

=== Componente: Inventario

.Diagrama de Componente de Inventario
image::../images/components/Inventario.jpeg[Diagrama de componente de Inventario, width=600, align=center]

==== Interfaz: IInventario

.Diagrama de Interfaz de Inventario
image::../images/interfaceDiagrams/IInventario.png[Diagrama de Interfaz de Inventario, width=600, align=center]

[options="header", cols="1,2,2"]
|===
|Operación |Precondición(es) |Postcondición(es)

| *actualizarEstadoHabitacion(int, string): boolean*
| El idHabitacion debe existir en el sistema. El nuevoEstado debe ser un valor válido (ej. "DISPONIBLE", "OCUPADA", "MANTENIMIENTO").
| El estado de la habitación se actualiza en la base de datos de inventario. Retorna true.

| *consultarDisponibilidad(CriteriosDisponibilidadDTO): TipoHabitacion[]*
| El CriteriosDisponibilidadDTO no es nulo y contiene fechas válidas (fechaInicio < fechaFin) y un idHotel existente.
| Retorna una lista (posiblemente vacía) de TipoHabitacion que cumplen los criterios y tienen al menos una habitación disponible en el rango de fechas.

| *consultarInventarioGlobal(): InventarioGlobalDTO[]*
| El usuario debe tener permisos de Administrador (verificado por IAutenticacion).
| Retorna una lista que consolida el estado de todos los tipos de habitación en todos los hoteles de la cadena.

| *gestionarCatalogo(string, TipoHabitacion): boolean*
| El usuario debe tener permisos de Administrador. La operacion es válida (ej. "CREAR"). La entidad TipoHabitacion u Hotel tiene datos válidos.
| La entidad se crea, modifica o elimina en el catálogo maestro. Retorna true.

| *monitorearOcupacion(int): OcupacionDTO*
| El usuario debe tener permisos de Administrador. El idHotel debe existir.
| Retorna un DTO con el porcentaje de ocupación actual para el hotel especificado.
|===

.Diagrama de comunicación actualizarEstadoHabitación
image::../images/comunication/actualizarEstadoHabitacion.png[Diagrama de comunicación Actualizar estado de habitación, width=600, align=center]

.Diagrama de comunicación consultarDisponibilidad
image::../images/comunication/consultarDisponibilidad.png[Diagrama de comunicación Consultar disponibilidad, width=600, align=center]

.Diagrama de comunicación consultarInventarioGlobal
image::../images/comunication/consultarInventarioGlobal.png[Diagrama de comunicación Consultar inventario global, width=600, align=center]

.Diagrama de comunicación gestionarCatalogo
image::../images/comunication/gestionarCatalogo.png[Diagrama de comunicación Gestionar catálogo, width=600, align=center]

.Diagrama de comunicación monitorearOcupacion
image::../images/comunication/monitorearOcupacion.png[Diagrama de comunicación Monitorear ocupación, width=600, align=center]

---

=== Componente: Reservaciones

.Diagrama de Componente de Reservaciones
image::../images/components/Reservaciones.jpeg[Diagrama de componente de Reservaciones, width=600, align=center]

==== Interfaz: IGestionReservacion

.Diagrama de Interfaz de Gestión de reservaciones
image::../images/interfaceDiagrams/IGestionReservacion.png[Diagrama de interfaz de Gestión de Reservaciones, width=600, align=center]

[options="header", cols="1,2,2"]
|===
|Operación |Precondición(es) |Postcondición(es)

| *hacerReservacion(DatosReservacionDTO): Reservacion*
| Los datos del cliente son válidos. Se ha obtenido un bloqueo de habitación exitoso desde IInventario. Se ha recibido una Transaccion "APROBADA" desde IPago.
| Se crea una nueva entidad Reservacion en la BD con estado "CONFIRMADA". Se solicita a IInventario que confirme el bloqueo. Se solicita notificación a INotificaciones. Retorna Reservacion.

| *cancelarReservacion(int): boolean*
| idReserva debe existir y estar "CONFIRMADA". Política de cancelación permite operación.
| Estado de la Reservacion se actualiza a "CANCELADA". Se libera inventario. Se solicita reembolso si aplica. Se notifica al cliente. Retorna true.

| *modificarReservacion(int, DatosModificacionDTO): Reservacion*
| idReserva existe y está "CONFIRMADA". Política permite modificaciones. Disponibilidad en IInventario. Pago adicional procesado si aplica.
| La Reservacion se actualiza con los nuevos datos. Inventario actualizado. Retorna la Reservacion actualizada.
|===

.Diagrama de comunicación hacerReservacion
image::../images/comunication/hacerReservacion.png[Diagrama de comunicación Hacer reservación, width=600, align=center]

.Diagrama de comunicación cancelarReservacion
image::../images/comunication/cancelarReservacion.png[Diagrama de comunicación Cancelar reservación, width=600, align=center]

.Diagrama de comunicación modificarReservacion
image::../images/comunication/modificarReservacion.png[Diagrama de comunicación Modificar reservación, width=600, align=center]

==== Interfaz: IConsultaReservacion

.Diagrama de Interfaz de Consulta de reservaciones
image::../images/interfaceDiagrams/IConsultaReservacion.png[Diagrama de interfaz de Consulta de Reservaciones, width=600, align=center]

[options="header", cols="1,2,2"]
|===
|Operación |Precondición(es) |Postcondición(es)

| *buscarReservacionesPorCliente(int): Reservacion[]*
| idCliente válido o solicitante autorizado.
| Retorna lista de Reservacion asociadas al idCliente.

| *buscarReservacionPorID(int): ReservacionDetalladaDTO*
| idReserva existe. Solicitante autorizado.
| Retorna ReservacionDetalladaDTO con información completa.
|===

.Diagrama de comunicación buscarReservacionesPorCliente
image::../images/comunication/buscarReservacionesPorCliente.png[Diagrama de comunicación Buscar reservaciones por cliente, width=600, align=center]

.Diagrama de comunicación buscarReservacionesPorID
image::../images/comunication/buscarReservacionesPorID.png[Diagrama de comunicación Buscar reservaciones por ID, width=600, align=center]

---

=== Componente: Pagos

.Diagrama de Componente de Pagos
image::../images/components/Pagos.jpeg[Diagrama de componente de Pagos, width=600, align=center]

==== Interfaz: IPago

.Diagrama de Interfaz de Pagos
image::../images/interfaceDiagrams/IPago.png[Diagrama de interfaz de Pagos, width=600, align=center]

[options="header", cols="1,2,2"]
|===
|Operación |Precondición(es) |Postcondición(es)

| *procesarCobro(DatosPagoDTO, float): Transaccion*
| DatosPagoDTO válido, monto > 0, PSP activo.
| Solicitud al PSP, registro en BD. Retorna Transaccion con estado "APROBADA" o "RECHAZADA".

| *procesarReembolso(string, float): Transaccion*
| idTransaccionOriginal existe, monto válido.
| Solicitud de reembolso al PSP. Registro en BD. Retorna Transaccion con estado "PROCESADO" o "FALLIDO".
|===

.Diagrama de comunicación procesarCobro
image::../images/comunication/procesarCobro.png[Diagrama de comunicación Procesar cobro, width=600, align=center]

.Diagrama de comunicación procesarReembolso
image::../images/comunication/procesarReembolso.png[Diagrama de comunicación Procesar reembolso, width=600, align=center]

---

=== Componente: Notificaciones

.Diagrama de Componente de Notificaciones
image::../images/components/Notificaciones.jpeg[Diagrama de componente de Notificaciones, width=600, align=center]

==== Interfaz: INotificaciones

.Diagrama de Interfaz de Notificaciones
image::../images/interfaceDiagrams/INotificaciones.png[Diagrama de interfaz de Notificaciones, width=600, align=center]

[options="header", cols="1,2,2"]
|===
|Operación |Precondición(es) |Postcondición(es)

| *enviarAvisoCancelacion(InfoNotificacionDTO): boolean*
| InfoNotificacionDTO contiene correo válido, IServicioEmail disponible.
| Mensaje encolado asíncrono. Retorna true si se encoló.

| *enviarConfirmacionReservacion(InfoNotificacionDTO): boolean*
| InfoNotificacionDTO contiene correo válido, IServicioEmail disponible.
| Mensaje encolado asíncrono. Retorna true si se encoló.
|===

.Diagrama de comunicación enviarAvisoCancelacion
image::../images/comunication/enviarAvisoCancelacion.png[Diagrama de comunicación Enviar aviso de cancelación, width=600, align=center]

.Diagrama de comunicación enviarConfirmacionReservacion
image::../images/comunication/enviarConfirmacionReservacion.png[Diagrama de comunicación Enviar confirmación de reservación, width=600, align=center]

---

=== Componente: GestionEstancias

.Diagrama de Componente de Gestión de Estancias
image::../images/components/GestionEstancias.jpeg[Diagrama de componente de Gestión de Estancias, width=600, align=center]

==== Interfaz: IGestionEstancia

.Diagrama de Interfaz de Gestión de Estancias
image::../images/interfaceDiagrams/IGestionEstancia.png[Diagrama de interfaz de Gestión de Estancias, width=600, align=center]

[options="header", cols="1,2,2"]
|===
|Operación |Precondición(es) |Postcondición(es)

| *registrarCambioHabitacion(int, int): boolean*
| idEstancia activa, idNuevaHabitacion "DISPONIBLE".
| Se actualiza la Estancia y el estado de las habitaciones.

| *registrarCheckIn(int): Estancia*
| idReserva existe y está "CONFIRMADA", fecha actual = inicio reserva.
| Se crea Estancia "ACTIVA", habitación ocupada. Retorna Estancia.

| *registrarCheckOut(int): Factura*
| idEstancia existe y está "ACTIVA", pago de extras procesado.
| Estancia y Reservacion completadas. Habitación a "MANTENIMIENTO". Retorna Factura.
|===

.Diagrama de comunicación registrarCambioHabitacion
image::../images/comunication/registrarCambioHabitacion.png[Diagrama de comunicación Registrar cambio de habitación, width=600, align=center]

.Diagrama de comunicación registrarCheckIn
image::../images/comunication/registrarCheckIn.png[Diagrama de comunicación Registrar Check In, width=600, align=center]

.Diagrama de comunicación registrarCheckOut
image::../images/comunication/registrarCheckOut.png[Diagrama de comunicación Registrar Check Out, width=600, align=center]

---

=== Componente: AdministracionCentral

.Diagrama de Componente de Administración Central
image::../images/components/Administracion.jpeg[Diagrama de componente de Administración, width=600, align=center]

==== Interfaz: ITarifas

.Diagrama de Interfaz de Tarifas
image::../images/interfaceDiagrams/ITarifas.png[Diagrama de interfaz de Tarifas, width=600, align=center]

[options="header", cols="1,2,2"]
|===
|Operación |Precondición(es) |Postcondición(es)

| *gestionarPromocion(Promocion): boolean*
| Usuario autenticado como Admin. Promocion válida.
| Promocion creada o actualizada. Retorna true.

| *gestionarTarifaDiaria(Tarifa): boolean*
| Usuario Admin, Tarifa válida y asociada.
| Tarifa creada o actualizada. Retorna true.

| *obtenerTarifaCalculada(CriteriosTarifaDTO): TarifaCalculadaDTO*
| Criterios válidos. idTipoHabitacion y fechas existen.
| Retorna DTO con precio final calculado.
|===

.Diagrama de comunicación gestionarPromocion
image::../images/comunication/gestionarPromocion.png[Diagrama de comunicación Gestionar Promoción, width=600, align=center]

.Diagrama de comunicación gestionarTarifaDiaria
image::../images/comunication/gestionarTarifaDiaria.png[Diagrama de comunicación Gestionar tarifa diaria, width=600, align=center]

.Diagrama de comunicación obtenerTarifaCalculada
image::../images/comunication/obtenerTarifaCalculada.png[Diagrama de comunicación Obtener tarifa calculada, width=600, align=center]

---

=== Componente: Autenticacion

.Diagrama de Interfaz de Autenticacion
image::../images/interfaceDiagrams/IAutentication.png[Diagrama de interfaz de Autenticacion, width=600, align=center]

.Diagrama de comunicación iniciarSesion
image::../images/comunication/iniciarSesion.png[Diagrama de comunicación Iniciar sesión, width=600, align=center]

.Diagrama de comunicación validarToken
image::../images/comunication/validarToken.png[Diagrama de comunicación Validar token, width=600, align=center]

---

=== Componente: Catalogo

.Diagrama de Interfaz de Catalogo
image::../images/interfaceDiagrams/ICatalogo.png[Diagrama de interfaz de Catalogo, width=600, align=center]

.Diagrama de comunicación gestionarHotel
image::../images/comunication/gestionarHotel.png[Diagrama de comunicación Gestionar hotel, width=600, align=center]

.Diagrama de comunicación gestionarTipoHabitacion
image::../images/comunication/gestionarTipoHabitacion.png[Diagrama de comunicación Gestionar tipo habitación, width=600, align=center]

---

=== Componente: Usuarios

.Diagrama de Interfaz de Gestion de Usuarios
image::../images/interfaceDiagrams/IGestionUsuarios.png[Diagrama de interfaz de Gestión de Usuarios, width=600, align=center]

.Diagrama de comunicación crearUsuario
image::../images/comunication/crearUsuario.png[Diagrama de comunicación Crear usuario, width=600, align=center]

.Diagrama de comunicación modificarUsuario
image::../images/comunication/modificarUsuario.png[Diagrama de comunicación Modificar usuario, width=600, align=center]

.Diagrama de comunicación eliminarUsuario
image::../images/comunication/eliminarUsuario.png[Diagrama de comunicación Eliminar usuario, width=600, align=center]

.Diagrama de comunicación buscarUsuarioPorID
image::../images/comunication/buscarUsuarioPorID.png[Diagrama de comunicación Buscar usuario por ID, width=600, align=center]

---

=== Componente: ConsultaEstancia

.Diagrama de Interfaz de Consulta de Estancia
image::../images/interfaceDiagrams/IConsultaEstancia.png[Diagrama de interfaz de Consulta de Estancia, width=600, align=center]

.Diagrama de comunicación buscarEstanciaPorID
image::../images/comunication/buscarEstanciaPorID.png[Diagrama de comunicación Buscar estancia por ID, width=600, align=center]

.Diagrama de comunicación buscarEstanciaPorReserva
image::../images/comunication/buscarEstanciaPorReserva.png[Diagrama de comunicación Buscar estancia por reserva, width=600, align=center]

.Diagrama de comunicación buscarEstanciasActivas
image::../images/comunication/buscarEstanciasActivas.png[Diagrama de comunicación Buscar estancias activas, width=600, align=center]

---

=== Componente: PasarelaExterna

.Diagrama de Interfaz de Pasarela Externa
image::../images/interfaceDiagrams/IPasarelaExterna.png[Diagrama de interfaz de Pasarela Externa, width=600, align=center]

.Diagrama de comunicación autorizarCobro
image::../images/comunication/autorizarCobro.png[Diagrama de comunicación Autorizar cobro, width=600, align=center]

---

=== Componente: Politicas

.Diagrama de Interfaz de Políticas
image::../images/interfaceDiagrams/IPoliticas.png[Diagrama de interfaz de Políticas, width=600, align=center]

.Diagrama de comunicación gestionarPoliticaCancelacion
image::../images/comunication/gestionarPoliticaCancelacion.png[Diagrama de comunicación Gestionar política de cancelación, width=600, align=center]

.Diagrama de comunicación gestionarPoliticaOverbooking
image::../images/comunication/gestionarPoliticaOverbooking.png[Diagrama de comunicación Gestionar política de overbooking, width=600, align=center]

---

=== Componente: Reembolsos

.Diagrama de Interfaz de Reembolsos
image::../images/interfaceDiagrams/IReembolsos.png[Diagrama de interfaz de Reembolsos, width=600, align=center]

.Diagrama de comunicación ejecutarReembolso
image::../images/comunication/ejecutarReembolso.png[Diagrama de comunicación Ejecutar reembolso, width=600, align=center]

---

=== Componente: ServicioEmail

.Diagrama de Interfaz de Servicio de Email
image::../images/interfaceDiagrams/IServicioEmail.png[Diagrama de interfaz de Servicio de Email, width=600, align=center]

.Diagrama de comunicación enviarEmail
image::../images/comunication/enviarEmail.png[Diagrama de comunicación Enviar Email, width=600, align=center]
